<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting started with NucliTrack &#8212; nuclitrack  documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="#">nuclitrack  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="getting-started-with-nuclitrack">
<h1>Getting started with NucliTrack<a class="headerlink" href="#getting-started-with-nuclitrack" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
<div class="section" id="getting-started">
<h1>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>NucliTrack is designed as an easy to use Python 3 Application for tracking cell nuclei. We&#8217;re glad you have chosen to try our software out, please follow the following steps to track your first video.</p>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>To run NucliTrack you must have <a class="reference external" href="https://www.python.org/downloads/">Python3</a> installed we recomend using the <a class="reference external" href="https://www.continuum.io/downloads">Anaconda</a> distribution for windows users.</p>
<p>Once you&#8217;ve got Python3 up and running you will need a package called Cython. This is easily installed using the pip installer, from the terminal (linux/mac users) or anaconda command prompt (windows) type:</p>
<blockquote>
<div>&gt; pip install cython</div></blockquote>
<p>Now you&#8217;re ready to install NucliTrack:</p>
<blockquote>
<div>&gt; pip install nuclitrack</div></blockquote>
<p>Note: If Python2 is installed on your system, you might need to use the pip3 installer, to ensure everything works properly.</p>
</div>
<div class="section" id="launching-nuclitrack">
<h2>Launching NucliTrack<a class="headerlink" href="#launching-nuclitrack" title="Permalink to this headline">¶</a></h2>
<p>To launch nuclitrack start Python3 up in your terminal</p>
<blockquote>
<div>&gt; Python3</div></blockquote>
<p>Python should now be running. Import NucliTrack and this will load up the Pygame window:</p>
<blockquote>
<div>&gt;&gt; import nuclitrack</div></blockquote>
<p>Finally run the nuclitrack application</p>
<blockquote>
<div>&gt;&gt; nuclitrack.CellTrackApp().run()</div></blockquote>
<p>The application should be running now and you&#8217;re ready to get going.</p>
</div>
<div class="section" id="loading-time-series-images">
<h2>Loading time series images<a class="headerlink" href="#loading-time-series-images" title="Permalink to this headline">¶</a></h2>
<p>To get started you need a video of cells that need tracking. Importantly, the video must be stored as a sequence of individual tiff files, it doesn&#8217;t matter how they&#8217;re named but somwhere they must have zero padded time points e.g:</p>
<div class="line-block">
<div class="line">somename_ch1_01.tif</div>
<div class="line">somename_ch1_01.tif</div>
<div class="line">somename_ch1_01.tif</div>
</div>
<blockquote>
<div><p>...</p>
<p>somename_ch1_99.tif</p>
</div></blockquote>
<p>Different channels can be loaded as long as the image size and number of frame is the same:</p>
<div class="line-block">
<div class="line">somename_ch2_01.tif</div>
<div class="line">somename_ch2_01.tif</div>
<div class="line">somename_ch2_01.tif</div>
</div>
<blockquote>
<div><p>...</p>
<p>somename_ch2_99.tif</p>
</div></blockquote>
<p>Finally the first and last time point must have different digits:</p>
<div class="line-block">
<div class="line">somename_ch1_01.tif</div>
<div class="line">somename_ch1_39.tif</div>
</div>
<p>is ok but:</p>
<div class="line-block">
<div class="line">somename_ch1_01.tif</div>
<div class="line">somename_ch1_21.tif</div>
</div>
<p>would not work properly. whilst you may end up missing one image, we feel this is a small price to pay for not having to faff around with complex naming conventions.</p>
<p>A good set of videos to try the applicaiton out is the <a class="reference external" href="http://ctc2015.gryf.fi.muni.cz/Public/FirstEdition/">benchmark dataset</a> from the <a class="reference external" href="http://www.codesolorzano.com/celltrackingchallenge/Cell_Tracking_Challenge/Results_First_CTC.html">first cell tracking challenge</a>.</p>
<p>Select load data, and into the first box type a filename and press enter, this is where your tracking data will be saved. If you already have data in that file you can now load it by clicking load data.</p>
<p>To load your videos navigate to the folder containing them. Double click the first image in the sequence then click the &#8216;CH1 1st&#8217; button, then double click the last image in the sequence and click &#8216;CH last&#8217;.</p>
<p>You can now load the movie by clicking the load movie button. Alternativley, other channels can be loaded allowing data to be extracted from them, though only the first channel is used for semgentation. Finally if you have a file location copied to the clip board htis can be pasted into the textboxes for file name and ammended.</p>
<p>Note: pasting into the text box requires a double click as opposed to keyboard shortcut.</p>
<p>Finally choose a file name to store your parameters in hit enter, then click load data, this is seperate to the tracking file so you can resuse parameters for future experiments.</p>
<p>Click load data button again to minimise this window.</p>
</div>
<div class="section" id="segmentation">
<h2>Segmentation<a class="headerlink" href="#segmentation" title="Permalink to this headline">¶</a></h2>
<p>Now you&#8217;re ready to segment your imaging series. Segmentaiton is based on a watershed procedure. All the steps except the last two are designed to identify the center of individual nuclei, in the last two steps the aim is to accuratley mask every nuclei.</p>
<p>On the left hand side pf hte interface you should see a panel of sliders allowing you to segment the image. The best way to find out what they do is to play around, though a more detailed description for each control is below:</p>
<p>#       Clipping threshold: this sets the maximum intensity of the image, anything above this intensity is clipped to this intensity
#       Background Correction: background intensity variation is corrected by subtracting a really blurred version of the image from the original, this slideer controls how blurred this image is.
#       Blurring: prior to thresholding pixel noise must be reduced this slider adjusts how blurred the image used for thresholding is.
#       Theshold level: the slider here controls what level of intensity should be used to define what are nuclei and what is background. Don&#8217;t worry if nuclei are touching each other at this point.
#       Filter small objects: if htere are lot&#8217;s of small objects that have been thresholded but aren&#8217;t nuclei you can filter them out using this slider
#       Intensity or Distance: the next step is to identify local maximum wihtin the thresholded regions, ideally local maximum will exist in the center of each nuclei, the maximum intensity often doesn&#8217;t reflect the center of the nuclei or even worse may lead to multiple local maxima appearing in each cell. This function allows you to choose to what degree local maxima are defined by the intensity or distance from edge.
#       Peak local maxima: behind this slider is a funciton which identfies local intensity peaks in the image, the slider sets the minimum distance allowed between peaks.
#       Edge detection: this slider controls how blurry the image is prior to edges being marked, more blurry means edges are smoother though may match the shape less.
#       Watershed: behind this slider is the watershed funciton which calculates where the local basins of attraction are in the image, like marking valleys in a mountainous terrain. The selected peak local maxima represent the bottom of the valleys, by adjusting the slider the lowest area is made larer or smaller, this like mining into the side of mountains to force the valley to be larger.</p>
<p>Use the slider in the top left hand corner to navigate around the video and try out your segmentation paramters on other frames. Also other channel data can be visualised though these are not used for segmentation in the current edition.</p>
<p>Once you have acheived good segmentation it&#8217;s now time to save the parameters. Once this is done, minimise the segmentaiton window and click segment movie to apply your segmentation parameters to the entire image sequence. This may take a while depending on how fast your computer is and how large you movie is.</p>
<p>When segmentation is done a button will appear allowing you to visualise the results of segmentation and decide whether you want to go back and adjust parameters or move forward. If you are happy go ahead and minimise the view segment window.</p>
</div>
<div class="section" id="training-data">
<h2>Training Data<a class="headerlink" href="#training-data" title="Permalink to this headline">¶</a></h2>
<p>The algorithm that tracks yours cell is probabilistic. Meaning, it will assign a probability to every segment giving it a measure of whether it is likely to be a single nuclei, a mitotic nuclei, on that has left mitosis recently, or an erroneous segmetnaiton either, more than one nuclei or no nuclei.</p>
<p>To calculate the probabilities features must be extracted from each segment. Click extract features to do this, again this step may take a few minutes.</p>
<p>Now select the training data button, you will be presented with a window showing your segmented cells in gray.</p>
<p>The buttons on the right allow you select trainig data for the probabilistic tracking algorithm. Click a button then select cells in the window to assign them as either 1 cell, a mitotics cell or a cell that has just left mitosis. You probably want to select around 10 to 20 exmaples of single cells, and then 3 or 4 mitotic cells and 5 or 6 cells that have left mitosis.</p>
<p>If allot of semgentation errors have been made consider sleecting examples of these, but the algorithm usually works just fine without these exmaples.</p>
<p>Three new sliders also exist in the top left hand corner along with text, generally the default value swill work though you may want to adjust these if tracking is particularly slow:</p>
<p>#       The furthest left of these sliders determines how far (in pixels) the algorithm will search in the previous frame, this should roughly correspond to the largest jump that nulei are making between frames, however larger values will also mean tracking will take longer.
#       The middle of the three sliders determines the largest gap between frames that can occur in a track. Smaller values speed up tracking whilst larger values take longer.
#       The final slider changes the penalty for movement distance, smaller values mean less penalty than larger values. Reduce this if cells are moving allot whilst increase this value if cells make small movements.</p>
<p>Once everything is selected, click save training. A button for classifying cells will now appear. Click this to assign probabilities to every cell in the image sequence.</p>
<p>Everything is now ready for tracking, hit this button to begin tracking. A feed of cell scores will appear in the terminal after a short period of time, giving the total score of tracking. This will increase steadily as tracks are iterativley added.</p>
</div>
<div class="section" id="correcting-and-storing-tracks">
<h2>Correcting and Storing tracks<a class="headerlink" href="#correcting-and-storing-tracks" title="Permalink to this headline">¶</a></h2>
<p>With tracking complete you can now inspec tthe results of automated tracking by scrolling backwards and forwards through the video. For isngle fram movements you can also use the keyboard hotkeys (a) and (d).</p>
<p>To inspect data on a track click the select track button, or use the hotkey (z). Then select a labelled cell in the track segment window. Data on this track will now appear in the bottom window. You can jump from one frame to another in the movie, by clicking the jump button or pressing (w), then clicking on the graph. The tracking window will then jump to the frame as selected on the x axis.</p>
<p>Automated tracking is likely to make errors. Buttons on the left hand side let you correct these.</p>
<p>#       To add a segment to a track, click add segment (c) then select a segment on the screen.
#       To remove a segment click remove segment (v) then sleect a labelled segment on the screen.
#       To swap two tracks over in all proceeding frames, with a track selected, select swap tracks (x) then select another track on the screen.
#       To add a new track, sleect new track (n) then choose an unlabelled segment on the screen.</p>
<p>If you want to export data on all the track click save all to CSV. Otherwise you can select individual tracks and export oonly these selections. To do this with a track selected click store track. It should now be marked with a balck dot. Once you have selected all the tracks you want, then click export selected to csv.</p>
<p>Finally you can change which features you want to visualise using the text boxes on the right. Here choose a number representing</p>
</div>
<div class="section" id="contribute">
<h2>Contribute<a class="headerlink" href="#contribute" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Issue Tracker: github.com/$project/$project/issues</li>
<li>Source Code: github.com/$project/$project</li>
</ul>
</div>
<div class="section" id="support">
<h2>Support<a class="headerlink" href="#support" title="Permalink to this headline">¶</a></h2>
<p>If you are having issues, please let us know.
We have a mailing list located at: <a class="reference external" href="mailto:project&#37;&#52;&#48;google-groups&#46;com">project<span>&#64;</span>google-groups<span>&#46;</span>com</a></p>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>The project is licensed under the MIT license.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting started with NucliTrack</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
<li><a class="reference internal" href="#getting-started">Getting started</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#launching-nuclitrack">Launching NucliTrack</a></li>
<li><a class="reference internal" href="#loading-time-series-images">Loading time series images</a></li>
<li><a class="reference internal" href="#segmentation">Segmentation</a></li>
<li><a class="reference internal" href="#training-data">Training Data</a></li>
<li><a class="reference internal" href="#correcting-and-storing-tracks">Correcting and Storing tracks</a></li>
<li><a class="reference internal" href="#contribute">Contribute</a></li>
<li><a class="reference internal" href="#support">Support</a></li>
<li><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="#">nuclitrack  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Sam Cooper.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
  </body>
</html>